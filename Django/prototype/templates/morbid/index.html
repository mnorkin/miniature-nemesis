{% extends "morbid/base.html" %}

{% block content %}
<script type="text/javascript">
var index_page_type = "{{ptype}}";
</script>

<div class="latest_target_prices title {{ptype}}">
	
	<div class="now">Nov. 17, 2013</div>
	{% if ptype == 'grid' %}
	<a class="toggle" href="?ptype=list">Compare</a>
	{% else %}
	<a class="toggle" href="/?ptype=grid">Compare</a>
	{% endif %}
	
	{% if latest_target_prices %}
		<div class="pre_info">
			<span class="cr"><a href="?up"></a><a href="?down"></a></span>
			<span class="ac">Accuracy<a href="?up"></a><a href="?down"></a></span>
			<span class="pr">Profitability<a href="?up"></a><a class="active" href="?down"></a> </span>
			<span class="re">Reach time<a href="?up"></a><a href="?down"></a> </span>
		</div>
		<ul class="">
			{% for target in latest_target_prices  %}
				<li class="entry chart">
					<a class="ticket" href="{{ target.ticker.get_absolute_url }}">{{ target.ticker }}</a>
					<a class="analytic" href="{{ target.analytic.get_absolute_url }}">{{ target.analytic }}</a>
					<span class="price">{{ target.price }}</span>

					<span id="{{ target.analytic.slug}}_{{ target.ticker.slug }}" class="circle {% if target.change < 0 %}down{% elif target.change > 0 %}up{% endif %}">
						<strong>{{ target.change|floatformat:1|cut:"-" }}%</strong>
					</span>

					<script type="text/javascript">
						generate_pie( "{{ target.analytic.slug}}_{{ target.ticker.slug }}", "{{ target.change }}" )
					</script>

					<ul class="bar">
						{% for fap in target.fap %}
							<li id="{{ fap.feature.slug }}_{{ fap.analytic.slug }}_{{ fap.ticker.slug }}" class="feature"></li>
							<script type="text/javascript">
								generate_grid_element( "{{ fap.feature.slug }}_{{ fap.analytic.slug }}_{{ fap.ticker.slug }}", "{{ fap.value }}", "{{fap.feature.name}}" )
							</script>
						{% endfor %}
					</ul>
					<div class="bar_tooltip"></div>
				</li>

			{% endfor %}
			<br class="clear"/>
		</ul>
	{% else %}
		<p>Error, no target prices</p>
	{% endif %}
	
</div>
{% endblock %}
